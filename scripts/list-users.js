const { PrismaClient } = require('@prisma/client');

const prisma = new PrismaClient();

async function listUsers() {
  try {
    console.log('ğŸ‘¥ ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã‚’å–å¾—ä¸­...\n');

    const users = await prisma.user.findMany({
      select: {
        id: true,
        userId: true,
        name: true,
        role: true,
        createdAt: true,
        updatedAt: true
      },
      orderBy: {
        createdAt: 'desc'
      }
    });

    if (users.length === 0) {
      console.log('âŒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
      return;
    }

    console.log(`ğŸ“Š ç·ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°: ${users.length}äºº\n`);
    console.log('â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”');
    console.log('â”‚ ãƒ¦ãƒ¼ã‚¶ãƒ¼ID   â”‚ åå‰            â”‚ æ¨©é™            â”‚ ä½œæˆæ—¥          â”‚ æ›´æ–°æ—¥          â”‚');
    console.log('â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤');

    users.forEach(user => {
      const userId = user.userId.padEnd(11);
      const name = user.name.padEnd(15);
      const role = user.role.padEnd(15);
      const createdAt = user.createdAt.toLocaleDateString('ja-JP').padEnd(15);
      const updatedAt = user.updatedAt.toLocaleDateString('ja-JP').padEnd(15);
      
      console.log(`â”‚ ${userId} â”‚ ${name} â”‚ ${role} â”‚ ${createdAt} â”‚ ${updatedAt} â”‚`);
    });

    console.log('â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜');

    // æ¨©é™åˆ¥ã®çµ±è¨ˆ
    const roleStats = {};
    users.forEach(user => {
      roleStats[user.role] = (roleStats[user.role] || 0) + 1;
    });

    console.log('\nğŸ“ˆ æ¨©é™åˆ¥çµ±è¨ˆ:');
    Object.entries(roleStats).forEach(([role, count]) => {
      console.log(`- ${role}: ${count}äºº`);
    });

  } catch (error) {
    console.error('âŒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
  } finally {
    await prisma.$disconnect();
  }
}

// ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ
listUsers(); 